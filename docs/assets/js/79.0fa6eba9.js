(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{383:function(a,e,t){"use strict";t.r(e);var s=t(6),l=Object(s.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"一、ffmpeg"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、ffmpeg"}},[a._v("#")]),a._v(" 一、FFmpeg")]),a._v(" "),e("p",[a._v("FFmpeg是跨平台的音视频开发库")]),a._v(" "),e("p",[a._v("有很多知名项目都采用了FFmpeg，比如：")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.chromium.org/audio-video",target:"_blank",rel:"noopener noreferrer"}},[a._v("Google Chrome"),e("OutboundLink")],1),a._v("：浏览器")]),a._v(" "),e("li",[a._v("Firefox：浏览器")]),a._v(" "),e("li",[e("a",{attrs:{href:"https://www.videolan.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("VLC"),e("OutboundLink")],1),a._v("：跨平台播放器")]),a._v(" "),e("li",[e("a",{attrs:{href:"http://www.mplayerhq.hu/",target:"_blank",rel:"noopener noreferrer"}},[a._v("MPlayer"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/bilibili/ijkplayer",target:"_blank",rel:"noopener noreferrer"}},[a._v("ijkplayer"),e("OutboundLink")],1),a._v("：bilibili团队开发的Android/iOS播放器框架")]),a._v(" "),e("li",[a._v("Perian：Apple公司的QuickTime组件")])]),a._v(" "),e("p",[a._v("目录结构如下所示：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("bin")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("有编译好的可执行程序：ffmpeg.exe、ffplay.exe、ffprobe.exe，可以直接在命令行上使用，比如")]),a._v(" "),e("ul",[e("li",[e("em",[a._v("ffplay xx.mp4")]),a._v("：可以直接播放某个视频")]),a._v(" "),e("li",[e("em",[a._v("ffmpeg -version")]),a._v("：可以查看FFmpeg的版本号")])])]),a._v(" "),e("li",[e("p",[a._v("有运行时需要用到的动态库文件（*.dll）")])])])]),a._v(" "),e("li",[e("p",[a._v("doc：FFmpeg的使用文档")])]),a._v(" "),e("li",[e("p",[a._v("include：开发时需要包含的头文件")])]),a._v(" "),e("li",[e("p",[a._v("lib：链接时需要用到的库文件")])])]),a._v(" "),e("h2",{attrs:{id:"二、ffmpeg命令行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、ffmpeg命令行"}},[a._v("#")]),a._v(" 二、FFmpeg命令行")]),a._v(" "),e("p",[a._v("FFmpeg的bin目录中提供了3个命令（可执行程序）ffmpeg.exe、ffplay.exe、ffprobe.exe，可以直接在命令行上使用。")]),a._v(" "),e("h3",{attrs:{id:"_2-1、ffmpeg"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、ffmpeg"}},[a._v("#")]),a._v(" 2.1、ffmpeg")]),a._v(" "),e("p",[a._v("ffmpeg的主要作用：对音视频进行编解码。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将MP3文件转成WAV文件")]),a._v("\nffmpeg -i xx.mp3 yy.wav\n")])])]),e("p",[a._v("当输入命令"),e("em",[a._v("ffmpeg")]),a._v("时，可以看到ffmpeg命令的使用格式是：")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("ffmpeg "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("infile options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" -i infile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(". "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("outfile options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" outfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),e("p",[a._v("简化一下，常用格式是：")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("ffmpeg arg1 arg2 -i arg3 arg4 arg5\n")])])]),e("ul",[e("li",[a._v("arg1：全局参数")]),a._v(" "),e("li",[a._v("arg2：输入文件参数")]),a._v(" "),e("li",[a._v("arg3：输入文件")]),a._v(" "),e("li",[a._v("arg4：输出文件参数")]),a._v(" "),e("li",[a._v("arg5：输出文件")])]),a._v(" "),e("h4",{attrs:{id:"其他图片格式转yuv"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他图片格式转yuv"}},[a._v("#")]),a._v(" 其他图片格式转YUV")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffmpeg -i in.png -s 512x512 -pix_fmt yuv420p out.yuv\n")])])]),e("ul",[e("li",[e("p",[a._v("-s")]),a._v(" "),e("ul",[e("li",[a._v("设置图片的尺寸")]),a._v(" "),e("li",[a._v("可以用一些"),e("a",{attrs:{href:"https://ffmpeg.org/ffmpeg-all.html#Video-size",target:"_blank",rel:"noopener noreferrer"}},[a._v("固定字符串"),e("OutboundLink")],1),a._v("表示尺寸，比如hd720表示1280x720")]),a._v(" "),e("li",[a._v("如果不设置此选项，默认会跟随输入图片的尺寸")])])]),a._v(" "),e("li",[e("p",[a._v("-pix_fmt")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("设置像素格式")])]),a._v(" "),e("li",[e("p",[a._v("可以通过"),e("em",[a._v("ffmpeg -pix_fmts")]),a._v("查看FFmpeg支持的像素格式")])]),a._v(" "),e("li",[e("p",[a._v("如果不设置此选项，默认会跟随输入图片的像素格式")]),a._v(" "),e("ul",[e("li",[a._v("比如可能是rgb24、rgba8、pal8等")]),a._v(" "),e("li",[a._v("可以通过"),e("em",[a._v("ffprobe")]),a._v("查看某图片的像素格式，比如"),e("em",[a._v("ffprobe in.png")])])])])])])]),a._v(" "),e("h4",{attrs:{id:"yuv转其他图片格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#yuv转其他图片格式"}},[a._v("#")]),a._v(" YUV转其他图片格式")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffmpeg -s 512x512 -pix_fmt yuv420p -i in.yuv out.jpg\n")])])]),e("ul",[e("li",[a._v("这里必须得设置YUV的尺寸（"),e("em",[a._v("-s")]),a._v("）、像素格式（"),e("em",[a._v("-pix_fmt")]),a._v("）")]),a._v(" "),e("li",[a._v("这就类似于：对pcm进行编码时，必须得设置采样率（"),e("em",[a._v("-ar")]),a._v("）、声道数（"),e("em",[a._v("-ac")]),a._v("）、采样格式（"),e("em",[a._v("-f")]),a._v("）")])]),a._v(" "),e("h4",{attrs:{id:"pcm转成wav"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pcm转成wav"}},[a._v("#")]),a._v(" PCM转成WAV")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffmpeg -ar 44100 -ac 2 -f s16le -i out.pcm out.wav\n")])])]),e("p",[a._v("需要注意的是：上面命令生成的WAV文件头有78字节。对比44字节的文件头，它多增加了一个34字节大小的LIST chunk。")]),a._v(" "),e("p",[a._v("关于LIST chunk的参考资料：")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://stackoverflow.com/questions/63929283/what-is-a-list-chunk-in-a-riff-wav-header",target:"_blank",rel:"noopener noreferrer"}},[a._v("What is a “LIST” chunk in a RIFF/Wav header?"),e("OutboundLink")],1)]),a._v(" "),e("li",[e("a",{attrs:{href:"https://www.recordingblogs.com/wiki/list-chunk-of-a-wave-file",target:"_blank",rel:"noopener noreferrer"}},[a._v("List chunk (of a RIFF file)"),e("OutboundLink")],1)])]),a._v(" "),e("p",[a._v("加上一个输出文件参数*-bitexact*可以去掉LIST Chunk。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffmpeg -ar 44100 -ac 2 -f s16le -i out.pcm -bitexact out2.wav\n")])])]),e("h4",{attrs:{id:"帮助"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#帮助"}},[a._v("#")]),a._v(" 帮助")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 简易版")]),a._v("\nffmpeg -h\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 详细版")]),a._v("\nffmpeg -h long\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 完整版")]),a._v("\nffmpeg -h full\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 或者使用")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ffmpeg -help")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ffmpeg -help long")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ffmpeg -help full")]),a._v("\n")])])]),e("h3",{attrs:{id:"_2-2、ffprobe"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、ffprobe"}},[a._v("#")]),a._v(" 2.2、ffprobe")]),a._v(" "),e("p",[a._v("ffprobe的主要作用：查看音视频的参数信息。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 可以查看MP3文件的采样率、比特率、时长等信息\nffprobe xx.mp3\n")])])]),e("p",[a._v("当输入命令"),e("em",[a._v("ffprobe")]),a._v("时，可以看到ffprobe命令的使用格式是：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffprobe [OPTIONS] [INPUT_FILE]\n# OPTIONS：参数\n# INPUT_FILE：输入文件\n")])])]),e("h4",{attrs:{id:"帮助-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#帮助-2"}},[a._v("#")]),a._v(" 帮助")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 简易版\nffprobe -h\n# 详细版\nffprobe -h long\n# 完整版\nffprobe -h full\n \n# 或者使用\n# ffprobe -help\n# ffprobe -help long\n# ffprobe -help full\n")])])]),e("h3",{attrs:{id:"_2-3、ffplay"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、ffplay"}},[a._v("#")]),a._v(" 2.3、ffplay")]),a._v(" "),e("p",[a._v("fplay的主要作用：播放音视频。")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 播放MP3文件")]),a._v("\nffplay xx.mp3\n")])])]),e("p",[a._v("当输入命令"),e("em",[a._v("ffplay")]),a._v("时，可以看到ffplay命令的使用格式是：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("ffplay "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" input_file\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# options：参数")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# input_file：输入文件")]),a._v("\n")])])]),e("h4",{attrs:{id:"ffplay-播放pcm文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ffplay-播放pcm文件"}},[a._v("#")]),a._v(" ffplay 播放PCM文件")]),a._v(" "),e("p",[a._v("播放PCM需要指定相关参数：")]),a._v(" "),e("ul",[e("li",[e("p",[e("em",[a._v("ar")]),a._v("：采样率")])]),a._v(" "),e("li",[e("p",[e("em",[a._v("ac")]),a._v("：声道数")])]),a._v(" "),e("li",[e("p",[a._v("f：采样格式")]),a._v(" "),e("ul",[e("li",[e("p",[e("em",[a._v("s16le")]),a._v("：PCM signed 16-bit little-endian")])]),a._v(" "),e("li",[e("p",[a._v("更多PCM的采样格式可以使用命令查看")]),a._v(" "),e("ul",[e("li",[a._v("Windows："),e("em",[a._v("ffmpeg -formats | findstr PCM")])]),a._v(" "),e("li",[a._v("Mac："),e("em",[a._v("ffmpeg -formats | grep PCM")])])])])])])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("ffplay -ar "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("44100")]),a._v(" -ac "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" -f s16le out.pcm\n")])])]),e("h4",{attrs:{id:"ffplay-显示yuv数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ffplay-显示yuv数据"}},[a._v("#")]),a._v(" ffplay 显示YUV数据")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffplay -s 512x512 -pix_fmt yuv420p in.yuv\n# 在ffplay中\n# -s已经过期，建议改为：-video_size\n# -pix_fmt已经过期，建议改为：-pixel_format\nffplay -video_size 512x512 -pixel_format yuv420p in.yuv\n")])])]),e("ul",[e("li",[a._v("YUV中直接存储的是所有像素的颜色信息（可以理解为是图像的一种原始数据）")]),a._v(" "),e("li",[a._v("必须得设置YUV的尺寸（"),e("em",[a._v("-s")]),a._v("）、像素格式（"),e("em",[a._v("-pix_fmt")]),a._v("）才能正常显示")]),a._v(" "),e("li",[a._v("这就类似于：播放pcm时，必须得设置采样率（"),e("em",[a._v("-ar")]),a._v("）、声道数（"),e("em",[a._v("-ac")]),a._v("）、采样格式（"),e("em",[a._v("-f")]),a._v("）")])]),a._v(" "),e("p",[a._v("可以使用过滤器（filter）显示其中的单个分量（r、g、b、y、u、v）。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 只显示r分量\nffplay -vf extractplanes=r in.png\n \n# 只显示g分量\nffplay -vf extractplanes=g in.png\n \n# 只显示b分量\nffplay -vf extractplanes=b in.png\n \n# 只显示y分量\nffplay -video_size 512x512 -pixel_format yuv420p -vf extractplanes=y in.yuv\n# 只显示y分量\nffplay -video_size 512x512 -pixel_format yuv420p -vf extractplanes=u in.yuv\n# 只显示y分量\nffplay -video_size 512x512 -pixel_format yuv420p -vf extractplanes=v in.yuv\n")])])]),e("ul",[e("li",[e("p",[a._v("-vf")]),a._v(" "),e("ul",[e("li",[a._v("设置视频过滤器")]),a._v(" "),e("li",[a._v("等价写法："),e("em",[a._v("-filter:v")])])])]),a._v(" "),e("li",[e("p",[a._v("extractplanes")]),a._v(" "),e("ul",[e("li",[a._v("抽取单个分量的内容到灰度视频流中")])])])]),a._v(" "),e("h4",{attrs:{id:"帮助-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#帮助-3"}},[a._v("#")]),a._v(" 帮助")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("# 简易版\nffplay -h\n# 详细版\nffplay -h long\n# 完整版\nffplay -h full\n \n# 或者使用\n# ffplay -help\n# ffplay -help long\n# ffplay -help full\n")])])]),e("h3",{attrs:{id:"_2-4、hide-banner"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、hide-banner"}},[a._v("#")]),a._v(" 2.4、hide_banner")]),a._v(" "),e("p",[a._v("增加*-hide_bannder*参数可以隐藏一些冗余的描述信息：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffprobe xx.mp3\n \nffprobe -hide_banner xx.mp3\n \n# ffmpeg、ffprobe、ffplay都适用\n")])])]),e("h2",{attrs:{id:"三、编译ffmpeg"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、编译ffmpeg"}},[a._v("#")]),a._v(" 三、编译FFmpeg")]),a._v(" "),e("h3",{attrs:{id:"_3-1-安装依赖项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-安装依赖项"}},[a._v("#")]),a._v(" 3.1 安装依赖项")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("brew install yasm")]),a._v(" "),e("ul",[e("li",[a._v("ffmpeg的编译过程依赖yasm")]),a._v(" "),e("li",[a._v("若未安装yasm会出现错误：nasm/yasm not found or too old. Use --disable-x86asm for a crippled build.")])])]),a._v(" "),e("li",[e("p",[a._v("brew install sdl2")]),a._v(" "),e("ul",[e("li",[a._v("ffplay依赖于sdl2")]),a._v(" "),e("li",[a._v("如果缺少sdl2，就无法编译出ffplay")])])]),a._v(" "),e("li",[e("p",[a._v("brew install fdk-aac")]),a._v(" "),e("ul",[e("li",[a._v("不然会出现错误：ERROR: libfdk_aac not found")])])]),a._v(" "),e("li",[e("p",[a._v("brew install x264")]),a._v(" "),e("ul",[e("li",[a._v("不然会出现错误：ERROR: libx264 not found")])])]),a._v(" "),e("li",[e("p",[a._v("brew install x265")]),a._v(" "),e("ul",[e("li",[a._v("不然会出现错误：ERROR: libx265 not found")])])])]),a._v(" "),e("p",[a._v("其实x264、x265、sdl2都在曾经执行"),e("em",[a._v("brew install ffmpeg")]),a._v("的时候安装过了。")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("可以通过brew list的结果查看是否安装过")]),a._v(" "),e("ul",[e("li",[e("em",[a._v("brew list | grep fdk")])]),a._v(" "),e("li",[e("em",[a._v("brew list | grep x26")])]),a._v(" "),e("li",[e("em",[a._v("brew list | grep -E 'fdk|x26'")])])])]),a._v(" "),e("li",[e("p",[a._v("如果已经安装过，可以不用再执行"),e("em",[a._v("brew install")])])])]),a._v(" "),e("h3",{attrs:{id:"_3-2-configure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-configure"}},[a._v("#")]),a._v(" 3.2 configure")]),a._v(" "),e("p",[a._v("首先进入源码目录。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 我的源码放在了Downloads目录下")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/Downloads/ffmpeg-4.3.2\n")])])]),e("p",[a._v("然后执行源码目录下的"),e("em",[a._v("configure")]),a._v("脚本，设置一些编译参数，做一些编译前的准备工作。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("./configure --prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/ffmpeg --enable-shared --disable-static --enable-gpl  --enable-nonfree --enable-libfdk-aac --enable-libx264 --enable-libx265\n")])])]),e("ul",[e("li",[e("p",[e("em",[a._v("--prefix")])]),a._v(" "),e("ul",[e("li",[a._v("用以指定编译好的FFmpeg安装到哪个目录")]),a._v(" "),e("li",[a._v("一般放到/usr/local/ffmpeg中即可")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-shared")])]),a._v(" "),e("ul",[e("li",[a._v("生成动态库")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--disable-static")])]),a._v(" "),e("ul",[e("li",[a._v("不生成静态库")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-libfdk-aac")])]),a._v(" "),e("ul",[e("li",[a._v("将fdk-aac内置到FFmpeg中")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-libx264")])]),a._v(" "),e("ul",[e("li",[a._v("将x264内置到FFmpeg中")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-libx265")])]),a._v(" "),e("ul",[e("li",[a._v("将x265内置到FFmpeg中")])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-gpl")])]),a._v(" "),e("ul",[e("li",[a._v("x264、x265要求开启"),e("a",{attrs:{href:"https://www.gnu.org/licenses/gpl-3.0.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("GPL License"),e("OutboundLink")],1)])])]),a._v(" "),e("li",[e("p",[e("em",[a._v("--enable-nonfree")])]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/FFmpeg/FFmpeg/blob/master/LICENSE.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("fdk-aac与GPL不兼容"),e("OutboundLink")],1),a._v("，需要通过开启nonfree进行配置")])])])]),a._v(" "),e("p",[a._v("你可以通过"),e("em",[a._v("configure --help")]),a._v("命令查看每一个配置项的作用。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("./configure --help "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" static\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 结果如下所示")]),a._v("\n--disable-static         "),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v(" not build static libraries "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("no"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),e("h3",{attrs:{id:"_3-3-编译"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-编译"}},[a._v("#")]),a._v(" 3.3 编译")]),a._v(" "),e("p",[a._v("接下来开始解析源代码目录中的Makefile文件，进行编译。"),e("em",[a._v("-j8")]),a._v("表示允许同时执行8个编译任务。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" -j8\n")])])]),e("p",[a._v("对于经常在类Unix系统下接触C/C++开发的小伙伴来说，Makefile必然是不陌生的。这里给不了解Makefile的小伙伴简单科普一下：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Makefile描述了整个项目的编译和链接等规则")]),a._v(" "),e("ul",[e("li",[a._v("比如哪些文件需要编译？哪些文件不需要编译？哪些文件需要先编译？哪些文件需要后编译？等等")])])]),a._v(" "),e("li",[e("p",[a._v("Makefile可以使项目的编译变得自动化，不需要每次都手动输入一堆源文件和参数")]),a._v(" "),e("ul",[e("li",[a._v("比如原来需要这么写："),e("em",[a._v("gcc test1.c test2.c test3.c -o test")])])])])]),a._v(" "),e("h3",{attrs:{id:"_3-4-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-安装"}},[a._v("#")]),a._v(" 3.4 安装")]),a._v(" "),e("p",[a._v("将编译好的库安装到指定的位置：/usr/local/ffmpeg。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),e("h3",{attrs:{id:"_3-5-配置path"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-配置path"}},[a._v("#")]),a._v(" 3.5 配置PATH")]),a._v(" "),e("p",[a._v("为了让bin目录中的ffmpeg、ffprobe、ffplay在任意位置都能够使用，需要先将bin目录配置到环境变量PATH中。")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 编辑.zprofile")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" ~/.zprofile\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# .zprofile文件中写入以下内容")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/ffmpeg/bin:"),e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),a._v("\n \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 让.zprofile生效")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" ~/.zprofile\n")])])]),e("p",[a._v("如果你用的是bash，而不是zsh，只需要将上面的.zprofile换成.bash_profile。")]),a._v(" "),e("h3",{attrs:{id:"_3-6-验证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-验证"}},[a._v("#")]),a._v(" 3.6 验证")]),a._v(" "),e("p",[a._v("命令行上进行验证。")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ffmpeg -version\n \n# 结果如下所示\nffmpeg version 4.3.2 Copyright (c) 2000-2021 the FFmpeg developers\nbuilt with Apple clang version 12.0.0 (clang-1200.0.32.29)\nconfiguration: --prefix=/usr/local/ffmpeg --enable-shared --disable-static --enable-gpl --enable-nonfree --enable-libfdk-aac --enable-libx264 --enable-libx265\nlibavutil      56. 51.100 / 56. 51.100\nlibavcodec     58. 91.100 / 58. 91.100\nlibavformat    58. 45.100 / 58. 45.100\nlibavdevice    58. 10.100 / 58. 10.100\nlibavfilter     7. 85.100 /  7. 85.100\nlibswscale      5.  7.100 /  5.  7.100\nlibswresample   3.  7.100 /  3.  7.100\nlibpostproc    55.  7.100 / 55.  7.100\n")])])]),e("p",[a._v("可以通过"),e("em",[a._v("brew uninstall ffmpeg")]),a._v("卸载以前通过homebrew安装的FFmpeg。")])])}),[],!1,null,null,null);e.default=l.exports}}]);