(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{383:function(t,a,s){"use strict";s.r(a);var e=s(6),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、查看可用设备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、查看可用设备"}},[t._v("#")]),t._v(" 一、查看可用设备")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ffmpeg -devices\n")])])]),a("p",[t._v("Mac的输出结果如下所示：")]),t._v(" "),a("ul",[a("li",[t._v("列表中有个"),a("a",{attrs:{href:"https://ffmpeg.org/ffmpeg-all.html#avfoundation",target:"_blank",rel:"noopener noreferrer"}},[t._v("avfoundation"),a("OutboundLink")],1),t._v("，是Mac平台的多媒体系统库")]),t._v(" "),a("li",[t._v("我们可以使用avfoundation去操作多媒体输入设备（比如录音设备）")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Devices:\n D. = Demuxing supported\n .E = Muxing supported\n --\n D  avfoundation    AVFoundation input device\n D  lavfi           Libavfilter virtual input device\n  E sdl,sdl2        SDL2 output device\n")])])]),a("h2",{attrs:{id:"二、查看avfoundation支持的设备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、查看avfoundation支持的设备"}},[t._v("#")]),t._v(" 二、查看avfoundation支持的设备")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 查看dshow支持的设备\nffmpeg -f avfoundation -list_devices true -i ''\n")])])]),a("ul",[a("li",[a("p",[a("em",[t._v("-f avfoundation")])]),t._v(" "),a("ul",[a("li",[t._v("avfoundation支持的")])])]),t._v(" "),a("li",[a("p",[a("em",[t._v("-list_devices true")])]),t._v(" "),a("ul",[a("li",[t._v("打印出所有的设备")])])]),t._v(" "),a("li",[a("p",[a("em",[t._v("-i ''")]),t._v(" 或 "),a("em",[t._v('-i ""')])])]),t._v(" "),a("li",[a("p",[t._v("立即退出")])])]),t._v(" "),a("p",[t._v("输出结果如下")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AVFoundation video devices:\n [0] FaceTime高清摄像头（内建）\n [1] Capture screen 0\nAVFoundation audio devices:\n [0] MS-T800\n [1] Edu Audio Device\n [2] MacBook Pro麦克风\n")])])]),a("h2",{attrs:{id:"三、查看avfoundation参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、查看avfoundation参数"}},[t._v("#")]),t._v(" 三、查看avfoundation参数")]),t._v(" "),a("p",[t._v("通过命令查看一下avfoundation可以使用的参数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 从ffmpeg -devices命令的结果可以看得出来：avfoundation属于demuxer，而不是muxer\nffmpeg -h demuxer=avfoundation\n")])])]),a("p",[t._v("打印如下")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("Demuxer avfoundation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("AVFoundation input device"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":\nAVFoundation indev AVOptions:\n  -list_devices      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". list available devices "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -video_device_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("int"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" video device by index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" devices with same name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("starts at "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("from -1 to INT_MAX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default -1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -audio_device_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("int"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" audio device by index "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" devices with same name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("starts at "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("from -1 to INT_MAX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default -1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -pixel_format      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pix_fmt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" pixel "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default yuv420p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -framerate         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("video_rate"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" frame rate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ntsc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -video_size        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("image_size"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" video size\n  -capture_cursor    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". capture the "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("screen")]),t._v(" cursor "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -capture_mouse_clicks "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". capture the "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("screen")]),t._v(" mouse clicks "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -capture_raw_data  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". capture the raw data from device connection "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  -drop_late_frames  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("    .D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". drop frames that are available later than expected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("em",[t._v("-video_size")]),t._v("：分辨率")])]),t._v(" "),a("li",[a("p",[t._v("-pixel_format：像素格式")]),t._v(" "),a("ul",[a("li",[t._v("默认是yuv420p")])])]),t._v(" "),a("li",[a("p",[t._v("-framerate：帧率（每秒采集多少帧画面）")]),t._v(" "),a("ul",[a("li",[t._v("默认是"),a("a",{attrs:{href:"https://ffmpeg.org/ffmpeg-all.html#Video-rate",target:"_blank",rel:"noopener noreferrer"}},[t._v("ntsc"),a("OutboundLink")],1),t._v("，也就是30000/1001，约等于29.970030")])])]),t._v(" "),a("li",[a("p",[a("em",[t._v("-list_devices")]),t._v("：true表示列出avfoundation支持的所有设备")])])]),t._v(" "),a("h2",{attrs:{id:"四、指定设备进行录音"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、指定设备进行录音"}},[t._v("#")]),t._v(" 四、指定设备进行录音")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在Mac上通过编号指定设备")]),t._v("\nffmpeg -f avfoundation -i :2 out.wav\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# :0表示使用0号音频设备")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 0:2表示使用0号视频设备和2号音频设备")]),t._v("\n")])])]),a("h2",{attrs:{id:"五、指定设备进行录制视频"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、指定设备进行录制视频"}},[t._v("#")]),t._v(" 五、指定设备进行录制视频")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 使用0号视频设备\nffmpeg -f avfoundation -i 0 out.yuv\n")])])]),a("p",[t._v("然后你可能会遇到一个错误：这个设备（摄像头）不支持29.970030的帧率。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("Selected framerate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("29.970030")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" is not supported by the device\n")])])]),a("p",[t._v("重新设置个30的帧率试试。")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("ffmpeg -f avfoundation -framerate "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" -i "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" out.yuv\n")])])]),a("p",[t._v("然后你会看到以下提示信息。")]),t._v(" "),a("ul",[a("li",[t._v("这个设备（摄像头）不支持yuv420p")]),t._v(" "),a("li",[t._v("只支持uyvy422、yuyv422、nv12、0rgb、bgr0")]),t._v(" "),a("li",[t._v("并且自动选择使用uyvy422来替代yuv420p")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("Selected pixel "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("yuv420p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" is not supported by the input device.\nSupported pixel formats:\n  uyvy422\n  yuyv422\n  nv12\n  0rgb\n  bgr0\nOverriding selected pixel "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("format")]),t._v(" to use uyvy422 instead.\n")])])]),a("p",[t._v("与此同时，也成功开始采集摄像头的视频数据了。")]),t._v(" "),a("ul",[a("li",[t._v("像素格式：uyvy422")]),t._v(" "),a("li",[t._v("分辨率：1280x720")]),t._v(" "),a("li",[t._v("帧率：30")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("Input "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0, avfoundation, from '0':")]),t._v("\n    Stream "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0:0: Video: rawvideo, uyvy422, 1280x720")]),t._v("\n \nOutput "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0, rawvideo, to 'out.yuv':")]),t._v("\n    Stream "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#0:0: Video: rawvideo, uyvy422, 1280x720, 30 fps")]),t._v("\n")])])]),a("p",[t._v("播放录制好的YUV。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ffplay -video_size 1280x720 -pixel_format uyvy422 -framerate 30 out.yuv\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);