(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{367:function(v,t,_){"use strict";_.r(t);var a=_(6),e=Object(a.a)({},(function(){var v=this,t=v._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h2",{attrs:{id:"https"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https"}},[v._v("#")]),v._v(" HTTPS")]),v._v(" "),t("p",[v._v("超文本传输安全协议")]),v._v(" "),t("p",[v._v("端口：443")]),v._v(" "),t("h2",{attrs:{id:"ssl-tls"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssl-tls"}},[v._v("#")]),v._v(" SSL/TLS")]),v._v(" "),t("p",[v._v("TLS（Transport Layer Security），译为：传输层安全性协议")]),v._v(" "),t("p",[v._v("前身是SSL（Secure Sockets Layer），译为：安全套接层")]),v._v(" "),t("p",[v._v("HTTPS = HTTP+SSL/TLS")]),v._v(" "),t("p",[v._v("FTPS = FTP + SSL/TLS")]),v._v(" "),t("p",[v._v("SMTPS =SMTP + SSL/TLS")]),v._v(" "),t("p",[t("strong",[v._v("OpenSSL")]),v._v("  是SSL/TLS协议的来源实现")]),v._v(" "),t("p",[v._v("可以使用OpenSSL构建一套属于自己的CA，自己给自己颁发证书，称为“自签名证书”")]),v._v(" "),t("h2",{attrs:{id:"https-vs-http"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https-vs-http"}},[v._v("#")]),v._v(" HTTPS vs HTTP")]),v._v(" "),t("p",[v._v("优点：安全")]),v._v(" "),t("p",[v._v("缺点：")]),v._v(" "),t("ul",[t("li",[v._v("证书的费用")]),v._v(" "),t("li",[v._v("加解密计算性能消耗")]),v._v(" "),t("li",[v._v("降低访问速度")])]),v._v(" "),t("p",[v._v("HTTPS 的通信过程")]),v._v(" "),t("ol",[t("li",[v._v("TCP的3次握手")]),v._v(" "),t("li",[v._v("TLS 的链接")]),v._v(" "),t("li",[v._v("HTTP请求和响应")])]),v._v(" "),t("h2",{attrs:{id:"tls-链接过程-1-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tls-链接过程-1-2"}},[v._v("#")]),v._v(" TLS 链接过程 1.2")]),v._v(" "),t("p",[t("img",{attrs:{src:"http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/HTTPS-TLS%E8%BF%87%E7%A8%8B.png",alt:"HTTPS-TLS过程"}})]),v._v(" "),t("ol",[t("li",[t("p",[v._v("Client Hello")]),v._v(" "),t("p",[v._v("TLS 版本号，支持的加密组件列表，一个"),t("strong",[v._v("随机数")])])]),v._v(" "),t("li",[t("p",[v._v("Server Hello")]),v._v(" "),t("p",[v._v("TLS的版本号，选择的加密组件，一个"),t("strong",[v._v("随机数")])])]),v._v(" "),t("li",[t("p",[v._v("Certificate")]),v._v(" "),t("ol",[t("li",[v._v("服务器的公钥证书（被CA签名过的）")])])]),v._v(" "),t("li",[t("p",[v._v("Server Key Exchange")]),v._v(" "),t("ol",[t("li",[v._v("用以实现ECDHE（秘钥交换算法）算法的一个参数（Server Params）。Server Params经过服务器私钥签名")])])]),v._v(" "),t("li",[t("p",[v._v("Server Hello Done")]),v._v(" "),t("p",[v._v("告知客户端：协商部分结束")]),v._v(" "),t("p",[v._v("目前为止，客户端和服务器之间通过明文共享了 Client Random、Server Random、Server Params")]),v._v(" "),t("p",[v._v("而且，客户端也已经拿到了服务器的公钥证书，接下来，客户端会验证证书的真实有效性")])]),v._v(" "),t("li",[t("p",[v._v("Client Key Exchange")]),v._v(" "),t("p",[v._v("用以实现ECDHE算法的另一个参数（Client Params）")]),v._v(" "),t("p",[v._v("目前为止，客户端和服务器都拥有了ECDHE算法需要的2个参数：")]),v._v(" "),t("p",[v._v("Server Params、Client Params")]),v._v(" "),t("p",[v._v("客户端、服务器都可以 使用ECDHE算法根据Server Params、Client Params计算出一个新的随机密钥串：Pre-master secret")]),v._v(" "),t("p",[v._v("然后结合Client Random、Server Random、Pre-master secret生成一个主密钥")]),v._v(" "),t("p",[v._v("最后利用主密钥衍生出其他密钥：客户端发送用的会话密钥、服务器发送用的会话密钥等")])]),v._v(" "),t("li",[t("p",[v._v("Change Cipher Spec")]),v._v(" "),t("p",[v._v("告知服务器：之后的通信会采用计算出来的会话密钥进行加密")])]),v._v(" "),t("li",[t("p",[v._v("Finished")]),v._v(" "),t("ol",[t("li",[v._v("包含连接至今全部报文的整体校验值（摘要），加密之后发送给服务器")]),v._v(" "),t("li",[v._v("这次握手协商是否成功，要以服务器是否能够正确解密该报文作为判定标准")])])]),v._v(" "),t("li",[t("p",[v._v("Change Cipher Spec")])]),v._v(" "),t("li",[t("p",[v._v("Finished")]),v._v(" "),t("p",[v._v("到此为止，客户端服务器都验证加密解密没问题，握手正式结束")]),v._v(" "),t("p",[v._v("后面开始传输加密的HTTP请求和响应")])])]),v._v(" "),t("h2",{attrs:{id:"https抓包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https抓包"}},[v._v("#")]),v._v(" HTTPS抓包")]),v._v(" "),t("p",[v._v("Charles抓包")]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("help --\x3e SSL Proxying --\x3e 选择模拟器，移动设备，本机电脑\n选择要抓包的接口 enable SSL Proxying\n")])])]),t("p",[v._v("Wireshark")]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("设置环境变量SSLKEYLOGFILE（浏览器会将key信息导出到这个文件）\n设置完成后，最好重启一下操作系统 \n在Wireshark中选择这个文件  编辑 → 首选项 → Protocols → TLS\n")])])]),t("h2",{attrs:{id:"配置服务器https-配置tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器https-配置tomcat"}},[v._v("#")]),v._v(" 配置服务器HTTPS - 配置Tomcat")]),v._v(" "),t("p",[v._v("将证书*.jks文件放到TOMCAT_HOME/conf目录下")]),v._v(" "),t("p",[v._v("修改TOMCAT_HOME/conf/server.xml中的Connector")]),v._v(" "),t("p",[t("img",{attrs:{src:"http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/HTTPS-Tomcat%E9%85%8D%E7%BD%AE.png",alt:"HTTPS-Tomcat配置"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);