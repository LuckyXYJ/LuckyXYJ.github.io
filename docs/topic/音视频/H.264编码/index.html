<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>H.264编码 | LuckyXYJ</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/x-icon" href="/logo.svg">
    <meta name="description" content="iOS开发者个人成长笔记">
    
    <link rel="preload" href="/assets/css/0.styles.60aa9f3b.css" as="style"><link rel="preload" href="/assets/js/app.592d79eb.js" as="script"><link rel="preload" href="/assets/js/2.7f06bbfc.js" as="script"><link rel="preload" href="/assets/js/60.58364095.js" as="script"><link rel="prefetch" href="/assets/js/10.5ff67019.js"><link rel="prefetch" href="/assets/js/11.e0db9d81.js"><link rel="prefetch" href="/assets/js/12.fab96660.js"><link rel="prefetch" href="/assets/js/13.7039e992.js"><link rel="prefetch" href="/assets/js/14.064ad09f.js"><link rel="prefetch" href="/assets/js/15.86b07182.js"><link rel="prefetch" href="/assets/js/16.0ff6c248.js"><link rel="prefetch" href="/assets/js/17.d81e7663.js"><link rel="prefetch" href="/assets/js/18.aac0134d.js"><link rel="prefetch" href="/assets/js/19.4c3cebc7.js"><link rel="prefetch" href="/assets/js/20.0840adce.js"><link rel="prefetch" href="/assets/js/21.dbe1f633.js"><link rel="prefetch" href="/assets/js/22.8d77339a.js"><link rel="prefetch" href="/assets/js/23.2dd7cafd.js"><link rel="prefetch" href="/assets/js/24.416a46a9.js"><link rel="prefetch" href="/assets/js/25.1e6bbd6f.js"><link rel="prefetch" href="/assets/js/26.bafe62f3.js"><link rel="prefetch" href="/assets/js/27.7777231e.js"><link rel="prefetch" href="/assets/js/28.d4e70537.js"><link rel="prefetch" href="/assets/js/29.a631655d.js"><link rel="prefetch" href="/assets/js/3.e39b5ef6.js"><link rel="prefetch" href="/assets/js/30.f90e42aa.js"><link rel="prefetch" href="/assets/js/31.f40a629f.js"><link rel="prefetch" href="/assets/js/32.9bfe5ffc.js"><link rel="prefetch" href="/assets/js/33.5aeedaa5.js"><link rel="prefetch" href="/assets/js/34.4ffe0c7a.js"><link rel="prefetch" href="/assets/js/35.a1a8fbda.js"><link rel="prefetch" href="/assets/js/36.ed39d63f.js"><link rel="prefetch" href="/assets/js/37.93db8a26.js"><link rel="prefetch" href="/assets/js/38.c30ed749.js"><link rel="prefetch" href="/assets/js/39.ee8c4957.js"><link rel="prefetch" href="/assets/js/4.90a7f436.js"><link rel="prefetch" href="/assets/js/40.ee7ed2e3.js"><link rel="prefetch" href="/assets/js/41.67e53a6f.js"><link rel="prefetch" href="/assets/js/42.b38e7281.js"><link rel="prefetch" href="/assets/js/43.cc841c44.js"><link rel="prefetch" href="/assets/js/44.9e56cb53.js"><link rel="prefetch" href="/assets/js/45.188abbd7.js"><link rel="prefetch" href="/assets/js/46.1540adc2.js"><link rel="prefetch" href="/assets/js/47.266e0f38.js"><link rel="prefetch" href="/assets/js/48.7a49e664.js"><link rel="prefetch" href="/assets/js/49.d084cbd4.js"><link rel="prefetch" href="/assets/js/5.a070f222.js"><link rel="prefetch" href="/assets/js/50.00a719d2.js"><link rel="prefetch" href="/assets/js/51.145ee163.js"><link rel="prefetch" href="/assets/js/52.e8c0f7ae.js"><link rel="prefetch" href="/assets/js/53.5a69bcac.js"><link rel="prefetch" href="/assets/js/54.2e0de0cd.js"><link rel="prefetch" href="/assets/js/55.a530f5d8.js"><link rel="prefetch" href="/assets/js/56.226c3f74.js"><link rel="prefetch" href="/assets/js/57.e2d2ba53.js"><link rel="prefetch" href="/assets/js/58.d77cf86a.js"><link rel="prefetch" href="/assets/js/59.f54e5750.js"><link rel="prefetch" href="/assets/js/6.b2c3b25d.js"><link rel="prefetch" href="/assets/js/61.17687fd8.js"><link rel="prefetch" href="/assets/js/62.8117991f.js"><link rel="prefetch" href="/assets/js/63.ea8f2a38.js"><link rel="prefetch" href="/assets/js/64.ed8257e9.js"><link rel="prefetch" href="/assets/js/65.7502c221.js"><link rel="prefetch" href="/assets/js/66.ff32fe0d.js"><link rel="prefetch" href="/assets/js/67.7aac1395.js"><link rel="prefetch" href="/assets/js/68.ad930e8b.js"><link rel="prefetch" href="/assets/js/69.94e23bf6.js"><link rel="prefetch" href="/assets/js/7.9a97cf0e.js"><link rel="prefetch" href="/assets/js/70.84b52508.js"><link rel="prefetch" href="/assets/js/71.ae02c0a0.js"><link rel="prefetch" href="/assets/js/72.3339b701.js"><link rel="prefetch" href="/assets/js/73.27c308be.js"><link rel="prefetch" href="/assets/js/74.d6db2c60.js"><link rel="prefetch" href="/assets/js/75.208b3346.js"><link rel="prefetch" href="/assets/js/8.3be4059b.js"><link rel="prefetch" href="/assets/js/9.9cee7032.js">
    <link rel="stylesheet" href="/assets/css/0.styles.60aa9f3b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">LuckyXYJ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/?category=posts.html" class="nav-link">博客</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><!----> <span class="title" style="display:;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topic/iOS优化/" class="nav-link">OS优化</a></li><li class="dropdown-item"><!----> <a href="/topic/Objective-C/" class="nav-link">Objective-C</a></li><li class="dropdown-item"><!----> <a href="/topic/Swift/" class="nav-link">Swift</a></li><li class="dropdown-item"><!----> <a href="/topic/网络协议/" class="nav-link">网络协议</a></li><li class="dropdown-item"><!----> <a href="/topic/音视频/" class="nav-link">音视频</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/LuckyXYJ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="http://xingyajie.tech/atom.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rss
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/?category=posts.html" class="nav-link">博客</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><!----> <span class="title" style="display:;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/topic/iOS优化/" class="nav-link">OS优化</a></li><li class="dropdown-item"><!----> <a href="/topic/Objective-C/" class="nav-link">Objective-C</a></li><li class="dropdown-item"><!----> <a href="/topic/Swift/" class="nav-link">Swift</a></li><li class="dropdown-item"><!----> <a href="/topic/网络协议/" class="nav-link">网络协议</a></li><li class="dropdown-item"><!----> <a href="/topic/音视频/" class="nav-link">音视频</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/LuckyXYJ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="http://xingyajie.tech/atom.xml" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Rss
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/" aria-current="page" class="sidebar-link">音视频</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E8%A7%86%E9%A2%91-%E5%9B%BE%E5%83%8F/" class="sidebar-link">音视频-图像</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E8%A7%86%E9%A2%91--%E5%A3%B0%E9%9F%B3/" class="sidebar-link">音视频--声音</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E5%BD%95%E5%88%B6%E4%B8%8E%E6%92%AD%E6%94%BE%E7%BC%96%E7%A0%81/" class="sidebar-link">音频录制与播放编码</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E8%A7%86%E9%A2%91%E5%BD%95%E5%88%B6%E4%B8%8E%E6%92%AD%E6%94%BE%E7%BC%96%E7%A0%81/" class="sidebar-link">视频录制与播放编码</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E9%87%8D%E9%87%87%E6%A0%B7/" class="sidebar-link">音频重采样</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91%E5%BA%93-FFmpeg/" class="sidebar-link">音视频开发库-FFmpeg</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/Untitled/" class="sidebar-link">FFmpeg音视频录制</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E5%A4%84%E7%90%86-ACC%E7%BC%96%E7%A0%81/" class="sidebar-link">音频处理-ACC编码</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E5%A4%84%E7%90%86-ACC%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0/" class="sidebar-link">音频处理-ACC编码实现</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/" aria-current="page" class="active sidebar-link">H.264编码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/#一、h-264编码" class="sidebar-link">一、H.264编码</a></li><li class="sidebar-sub-header level2"><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/#二、编码器" class="sidebar-link">二、编码器</a></li><li class="sidebar-sub-header level2"><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/#三、解码器" class="sidebar-link">三、解码器</a></li><li class="sidebar-sub-header level2"><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/#四、编码过程与原理" class="sidebar-link">四、编码过程与原理</a></li><li class="sidebar-sub-header level2"><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81/#五、规格" class="sidebar-link">五、规格</a></li></ul></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E5%A4%84%E7%90%86-ACC%E8%A7%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/" class="sidebar-link">音频处理-ACC解码实现</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0/" class="sidebar-link">H.264编码实现</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%9F%B3%E9%A2%91%E5%A4%84%E7%90%86-PCM%E8%BD%ACWAV/" class="sidebar-link">音频处理-PCM转WAV</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E8%A7%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/" class="sidebar-link">H.264解码实现</a></li><li><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%A2%9C%E8%89%B2b/" class="sidebar-link">颜色编码-YUV</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=topic" title="分类" data-v-06225672>topic</a></li><li data-v-06225672><a href="/categories/?category=%E9%9F%B3%E8%A7%86%E9%A2%91" title="分类" data-v-06225672>音视频</a></li><li data-v-06225672><a href="/categories/?category=264%E7%BC%96%E7%A0%81" title="分类" data-v-06225672>264编码</a></li></ul> <div class="info" data-v-06225672><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-03-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">H.264编码<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="一、h-264编码"><a href="#一、h-264编码" class="header-anchor">#</a> 一、H.264编码</h2> <p>H.264，又称为MPEG-4 Part 10，Advanced Video Coding。</p> <ul><li>译为：MPEG-4第10部分，高级视频编码</li> <li>简称：MPEG-4 AVC</li></ul> <p>H.264编码的压缩比可以达到至少是100:1</p> <p>H.264是迄今为止视频录制、压缩和分发的最常用格式。截至2019年9月，已有91％的视频开发人员使用了该格式。H.264提供了明显优于以前任何标准的压缩性能。H.264因其是蓝光盘的其中一种编解码标准而著名，所有蓝光盘播放器都必须能解码H.264。</p> <h2 id="二、编码器"><a href="#二、编码器" class="header-anchor">#</a> 二、编码器</h2> <p><a href="https://en.wikipedia.org/wiki/X264" target="_blank" rel="noopener noreferrer">x264<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一款免费的高性能的H.264开源编码器。x264编码器在FFmpeg中的名称是libx264。</p> <div class="language- extra-class"><pre class="language-text"><code>AVCodec *codec = avcodec_find_encoder_by_name(&quot;libx264&quot;);
</code></pre></div><h2 id="三、解码器"><a href="#三、解码器" class="header-anchor">#</a> 三、解码器</h2> <p>FFmpeg默认已经内置了一个H.264的解码器，名称是h264</p> <div class="language- extra-class"><pre class="language-text"><code>AVCodec *codec1 = avcodec_find_decoder_by_name(&quot;h264&quot;);
 
// 或者
AVCodec *codec2 = avcodec_find_decoder(AV_CODEC_ID_H264);
</code></pre></div><h2 id="四、编码过程与原理"><a href="#四、编码过程与原理" class="header-anchor">#</a> 四、编码过程与原理</h2> <p>编码主要步骤：</p> <ul><li>划分帧类型</li> <li>帧内/帧间编码</li> <li>变换 + 量化</li> <li>滤波</li> <li>熵编码</li></ul> <h3 id="_4-1-划分帧类型"><a href="#_4-1-划分帧类型" class="header-anchor">#</a> 4.1 划分帧类型</h3> <p>有统计结果表明：在连续的几帧图像中，一般只有10%以内的像素有差别，亮度的差值变化不超过2%，而色度的差值变化只在1%以内。</p> <h4 id="gop"><a href="#gop" class="header-anchor">#</a> GOP</h4> <p>于是可以将一串连续的相似的帧归到一个图像群组（Group Of Pictures，GOP）。</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524113111511-1081267267.png" alt="GOP">​</p> <p>GOP中的帧可以分为3种类型：</p> <ul><li><p>I 帧（I Picture、I Frame、Intra Coded Picture），译为：帧内编码图像，也叫做关键帧（Keyframe）</p> <ul><li><p>是视频的第一帧，也是GOP的第一帧，一个GOP只有一个I帧</p></li> <li><p>编码</p> <ul><li>对整帧图像数据进行编码</li></ul></li> <li><p>解码</p> <ul><li>仅用当前I帧的编码数据就可以解码出完整的图像</li></ul></li> <li><p>是一种自带全部信息的独立帧，无需参考其他图像便可独立进行解码，可以简单理解为一张静态图像</p></li></ul></li> <li><p>P帧（P Picture、P Frame、Predictive Coded Picture），译为：预测编码图像</p> <ul><li><p>编码</p> <ul><li>并不会对整帧图像数据进行编码</li> <li>以前面的I帧或P帧作为参考帧，只编码当前P帧与参考帧的差异数据</li></ul></li> <li><p>解码</p> <ul><li>需要先解码出前面的参考帧，再结合差异数据解码出当前P帧完整的图像</li></ul></li></ul></li> <li><p>B帧（B Picture、B Frame、Bipredictive Coded Picture），译为：前后预测编码图像</p> <ul><li><p>编码</p> <ul><li>并不会对整帧图像数据进行编码</li> <li>同时以前面、后面的I帧或P帧作为参考帧，只编码当前B帧与前后参考帧的差异数据</li> <li>因为可参考的帧变多了，所以只需要存储更少的差异数据</li></ul></li> <li><p>解码</p> <ul><li>需要先解码出前后的参考帧，再结合差异数据解码出当前B帧完整的图像</li></ul></li></ul></li></ul> <p>不难看出，编码后的数据大小：I帧 &gt; P帧 &gt; B帧。</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524145850997-158052138.png" alt="显示和编码顺序">​</p> <p>在较早的视频编码标准（例如MPEG-2）中，P帧只能使用一个参考帧，而一些现代视频编码标准（比如H.264），允许使用多个参考帧。</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524192349714-1741005171.jpg" alt="多个参考帧">​</p> <h4 id="gop的长度"><a href="#gop的长度" class="header-anchor">#</a> GOP的长度</h4> <p>GOP的长度表示GOP的帧数。GOP的长度需要控制在合理范围，以平衡视频质量、视频大小（网络带宽）和seek效果（拖动、快进的响应速度）等。</p> <ul><li>加大GOP长度有利于减小视频文件大小，但也不宜设置过大，太大则会导致GOP后部帧的画面失真，影响视频质量</li> <li>由于P、B帧的复杂度大于I帧，GOP值过大，过多的P、B帧会影响编码效率，使编码效率降低</li> <li>如果设置过小的GOP值，视频文件会比较大，则需要提高视频的输出码率，以确保画面质量不会降低，故会增加网络带宽</li> <li>GOP长度也是影响视频seek响应速度的关键因素，seek时播放器需要定位到离指定位置最近的前一个I帧，如果GOP太大意味着距离指定位置可能越远（需要解码的参考帧就越多）、seek响应的时间（缓冲时间）也越长</li></ul> <h4 id="gop的类型"><a href="#gop的类型" class="header-anchor">#</a> GOP的类型</h4> <p>GOP又可以分为开放（Open）、封闭（Closed）两种。</p> <ul><li><p>Open</p> <ul><li>前一个GOP的B帧可以参考下一个GOP的I帧</li></ul></li> <li><p>Closed</p> <ul><li>前一个GOP的B帧不能参考下一个GOP的I帧</li> <li>GOP不能以B帧结尾</li></ul></li></ul> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524151511069-453114588.png" alt="长度为15的Open GOP">​</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524151513095-1975140503.png" alt="长度为15的Closed GOP">​</p> <p>需要注意的是：</p> <ul><li>由于P帧、B帧都对前面的参考帧（P帧、I帧）有依赖性，因此，一旦前面的参考帧出现数据错误，就会导致后面的P帧、B帧也出现数据错误，而且这种错误还会继续向后传播</li> <li>对于普通的I帧，其后的P帧和B帧可以参考该普通I帧之前的其他I帧</li></ul> <p>在Closed GOP中，有一种特殊的I帧，叫做IDR帧（Instantaneous Decoder Refresh，译为：即时解码刷新）。</p> <ul><li>当遇到IDR帧时，会清空参考帧队列</li> <li>如果前一个序列出现重大错误，在这里可以获得重新同步的机会，使错误不会继续往下传播</li> <li>一个IDR帧之后的所有帧，永远都不会参考该IDR帧之前的帧</li> <li>视频播放时，播放器一般都支持随机seek（拖动）到指定位置，而播放器直接选择到指定位置附近的IDR帧进行播放最为便捷，因为可以明确知道该IDR帧之后的所有帧都不会参考其之前的其他I帧，从而避免较为复杂的反向解析</li></ul> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524151514840-1369205865.png" alt="IDR">​</p> <h3 id="_4-2-帧内-帧间编码"><a href="#_4-2-帧内-帧间编码" class="header-anchor">#</a> 4.2 帧内/帧间编码</h3> <p>I帧采用的是帧内（Intra Frame）编码，处理的是空间冗余。</p> <p>P帧、B帧采用的是帧间（Inter Frame）编码，处理的是时间冗余。</p> <h4 id="划分宏块"><a href="#划分宏块" class="header-anchor">#</a> 划分宏块</h4> <p>在进行编码之前，首先要将一张完整的帧切割成多个宏块（Macroblock），H.264中的宏块大小通常是16x16。</p> <p>宏块可以进一步拆分为多个更小的变换块（Transform blocks）、预测块（Prediction blocks）。</p> <ul><li>变换块的尺寸有：16x16、8x8、4x4</li> <li>预测块的尺寸有：16×16、16×8、8×16、8×8、8×4、4×8、4×4</li></ul> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524184947061-764686480.png" alt="预测块">​</p> <h4 id="帧内编码"><a href="#帧内编码" class="header-anchor">#</a> 帧内编码</h4> <p>帧内编码，也称帧内预测。以4x4的预测块为例，共有9种可选的预测模式。</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524193503211-376585236.png" alt="预测模式">​</p> <p>​<img src="http://xingyajie.oss-cn-hangzhou.aliyuncs.com/uPic/497279-20210524193505340-1505666021.png" alt="预测模式描述">​</p> <p>利用帧内预测技术，可以得到预测帧，最终只需要保留预测模式信息、以及预测帧与原始帧的残差值。</p> <p>编码器会选取最佳预测模式，使预测帧更加接近原始帧，减少相互间的差异，提高编码的压缩效率。</p> <h4 id="帧间编码"><a href="#帧间编码" class="header-anchor">#</a> 帧间编码</h4> <p>帧间编码，也称帧间预测，用到了运动补偿（Motion compensation）技术。</p> <p>编码器利用块匹配算法，尝试在先前已编码的帧（称为参考帧）上搜索与正在编码的块相似的块。如果编码器搜索成功，则可以使用称为运动矢量的向量对块进行编码，该向量指向匹配块在参考帧处的位置。</p> <p>在大多数情况下，编码器将成功执行，但是找到的块可能与它正在编码的块不完全匹配。这就是编码器将计算它们之间差异的原因。这些残差值称为预测误差，需要进行变换并将其发送给解码器。</p> <p>综上所述，如果编码器在参考帧上成功找到匹配块，它将获得指向匹配块的运动矢量和预测误差。使用这两个元素，解码器将能够恢复该块的原始像素。</p> <p>如果一切顺利，该算法将能够找到一个几乎没有预测误差的匹配块，因此，一旦进行变换，运动矢量加上预测误差的总大小将小于原始编码的大小。</p> <p>如果块匹配算法未能找到合适的匹配，则预测误差将是可观的。因此，运动矢量的总大小加上预测误差将大于原始编码。在这种情况下，编码器将产生异常，并为该特定块发送原始编码。</p> <h3 id="变换与量化"><a href="#变换与量化" class="header-anchor">#</a> 变换与量化</h3> <p>接下来对残差值进行DCT变换（Discrete Cosine Transform，译为离散余弦变换）。</p> <h2 id="五、规格"><a href="#五、规格" class="header-anchor">#</a> 五、规格</h2> <p>H.264的主要规格有：</p> <ul><li><p>Baseline Profile（BP）</p> <ul><li>支持I/P帧，只支持无交错（Progressive）和CAVLC</li> <li>一般用于低阶或需要额外容错的应用，比如视频通话、手机视频等即时通信领域</li></ul></li> <li><p>Extended Profile（XP）</p> <ul><li>在Baseline的基础上增加了额外的功能，支持流之间的切换，改进误码性能</li> <li>支持I/P/B/SP/SI帧，只支持无交错（Progressive）和CAVLC</li> <li>适合于视频流在网络上的传输场合，比如视频点播</li></ul></li> <li><p>Main Profile（MP）</p> <ul><li>提供I/P/B帧，支持无交错（Progressive）和交错（Interlaced），支持CAVLC和CABAC</li> <li>用于主流消费类电子产品规格如低解码（相对而言）的MP4、便携的视频播放器、PSP和iPod等</li></ul></li> <li><p>High Profile（HiP）</p> <ul><li><p>最常用的规格</p></li> <li><p>在Main的基础上增加了8x8内部预测、自定义量化、无损视频编码和更多的YUV格式（如4:4:4）</p> <ul><li>High 4:2:2 Profile（Hi422P）</li> <li>High 4:4:4 Predictive Profile（Hi444PP）</li> <li>High 4:2:2 Intra Profile</li> <li>High 4:4:4 Intra Profile</li></ul></li> <li><p>用于广播及视频碟片存储（蓝光影片），高清电视的应用</p></li></ul></li></ul></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/%E9%A2%9C%E8%89%B2b/"><div>
            颜色编码-YUV
            <!----></div></a> <span class="date">03-16</span></dt></dl><dl><dd>02</dd> <dt><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0/"><div>
            H.264编码实现
            <!----></div></a> <span class="date">03-16</span></dt></dl><dl><dd>03</dd> <dt><a href="/topic/%E9%9F%B3%E8%A7%86%E9%A2%91/H.264%E8%A7%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"><div>
            H.264解码实现
            <!----></div></a> <span class="date">03-16</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2015-2023
    <span>LuckyXYJ | <a href="http://beian.miit.gov.cn/">豫ICP备2021029639号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.592d79eb.js" defer></script><script src="/assets/js/2.7f06bbfc.js" defer></script><script src="/assets/js/60.58364095.js" defer></script>
  </body>
</html>
